<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0f172a" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
  <title>Athletic Specimen</title>

  <style>
  .table { width:100%; border-collapse:collapse; }
  .table thead th { text-align:left; font-weight:600; border-bottom:1px solid #333; padding:6px 8px; }
  .table tbody td { border-bottom:1px solid #222; padding:6px 8px; }
  .badge { display:inline-block; padding:2px 8px; border-radius:999px; background:#333; color:#ddd; font-size:12px; }
</style>

 <style>
  .view .row { margin: 12px 0; }
  .view .row label { display:block; font-weight:600; margin-bottom:6px; }
  .muted { opacity:0.75; font-size:0.9em; }
  .table { width:100%; border-collapse: collapse; }
  .table th, .table td { border:1px solid #ccc; padding:6px 8px; text-align:left; }
  .badge { padding:2px 6px; border-radius:6px; font-size:0.85em; background:#eee; }
  .fab-tournament {
    position: fixed; right: 16px; bottom: 16px; z-index: 1000;
    padding: 10px 14px; border-radius: 12px; border: 1px solid #ddd; background: #fff; cursor: pointer;
  }
</style>
</head>
<body>
  <div id="root">
    <div style="padding:2rem;text-align:center;font-family:sans-serif;color:#fff;">
      Loading app, please wait...
    </div>
  </div>

  <script>
    // Fail-safe loader â€” show message if JS fails to load
    window.addEventListener('error', function (e) {
      if (e.target.tagName === 'SCRIPT') {
        document.getElementById('root').innerHTML = `
          <div style="padding:2rem;text-align:center;font-family:sans-serif;color:#fff;">
            Failed to load app files. Try refreshing the page or check your connection.
          </div>
        `;
      }
    }, true);
  </script>

  ]<script>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('input, textarea, select, button').forEach(el => {
        el.style.fontSize = '16px';
      });
    });
    
    <button id="tab-tournament" class="tab-btn">Tournament</button>

  </script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script>

  <!-- Main App -->
  <script src="app.js" defer></script>

  <div id="view-tournament" class="view" style="display:none;">
  <div class="section">
    <h2>Tournament</h2>

    <div class="row">
      <label for="tournamentSelect">Tournament</label>
      <select id="tournamentSelect"></select>
    </div>

    <div class="row">
      <label>Public Schedule and Next Match</label>
      <div id="publicNextMatches"></div>
    </div>

    <div class="row">
      <label>Pool Standings</label>
      <div id="poolStandings"></div>
    </div>

    <div class="row">
      <label>Report Score</label>
      <div id="publicScoreReport">
        <select id="reportMatchSelect"></select>
        <input id="teamA_score" type="number" placeholder="Team A score" min="0" />
        <input id="teamB_score" type="number" placeholder="Team B score" min="0" />
        <input id="reporterTeam" type="text" placeholder="Your team name" />
        <button id="submitScoreBtn">Submit score</button>
        <div id="reportStatus" class="muted"></div>
      </div>
    </div>

    <hr/>

    <div id="adminTournament" class="admin-only" style="display:none;">
      <h3>Admin Controls</h3>

      <div class="row">
        <input id="newTournamentName" type="text" placeholder="Tournament name"/>
        <input id="newTournamentNets" type="number" min="1" placeholder="Number of nets"/>
        <button id="createTournamentBtn">Create tournament</button>
      </div>

      <div class="row">
        <label>Add Teams</label>
        <textarea id="bulkTeams" rows="4" placeholder="One team per line"></textarea>
        <button id="addTeamsBtn">Add teams to selected tournament</button>
      </div>

      <div class="row">
        <label>Define Pools</label>
        <textarea id="poolsJson" rows="6" placeholder='Example:
[
  {"name":"Pool A","teams":["Team 1","Team 2","Team 3","Team 4"]},
  {"name":"Pool B","teams":["Team 5","Team 6","Team 7","Team 8"]}
]'></textarea>
        <button id="savePoolsBtn">Save pools</button>
      </div>

      <div class="row">
        <label>Auto Create Pool Schedule</label>
        <button id="generatePoolScheduleBtn">Generate pool round robin with nets</button>
      </div>

      <div class="row">
        <label>Admin Rank View</label>
        <div id="adminRankings"></div>
      </div>
    </div>
  </div>
</div>
<button id="tab-tournament" class="tab-tournament">Tournament</button>

<div id="view-tournament" class="view" style="display:none; padding: 16px;">
  <div class="section" style="max-width:1000px; margin:0 auto;">
    <h2 style="margin-top:0;">Tournament</h2>

    <div class="row">
      <button id="closeTournamentBtn">Back to main app</button>
    </div>

    <div class="row">
      <label for="tournamentSelect">Tournament</label>
      <select id="tournamentSelect"></select>
    </div>

    <div class="row">
      <label>Public Schedule and Next Match</label>
      <div id="publicNextMatches"></div>
    </div>

    <div class="row">
      <label>Pool Standings</label>
      <div id="poolStandings"></div>
    </div>

    <div class="row">
      <label>Report Score</label>
      <div id="publicScoreReport">
        <select id="reportMatchSelect"></select>
        <input id="teamA_score" type="number" placeholder="Team A score" min="0" />
        <input id="teamB_score" type="number" placeholder="Team B score" min="0" />
        <input id="reporterTeam" type="text" placeholder="Your team name" />
        <button id="submitScoreBtn">Submit score</button>
        <div id="reportStatus" class="muted"></div>
      </div>
    </div>

    <hr/>

    <div id="adminTournament" style="display:none;">
      <h3>Admin Controls</h3>

      <div class="row">
        <input id="newTournamentName" type="text" placeholder="Tournament name"/>
        <input id="newTournamentNets" type="number" min="1" placeholder="Number of nets"/>
        <button id="createTournamentBtn">Create tournament</button>
      </div>

      <div class="row">
        <label>Add Teams</label>
        <textarea id="bulkTeams" rows="4" placeholder="One team per line"></textarea>
        <button id="addTeamsBtn">Add teams to selected tournament</button>
      </div>

      <div class="row">
        <label>Define Pools</label>
        <textarea id="poolsJson" rows="6" placeholder='Example:
[
  {"name":"Pool A","teams":["Team 1","Team 2","Team 3","Team 4"]},
  {"name":"Pool B","teams":["Team 5","Team 6","Team 7","Team 8"]}
]'></textarea>
        <button id="savePoolsBtn">Save pools</button>
      </div>

      <div class="row">
        <label>Auto Create Pool Schedule</label>
        <button id="generatePoolScheduleBtn">Generate pool round robin with nets</button>
      </div>

      <div class="row">
        <label>Admin Rank View</label>
        <div id="adminRankings"></div>
      </div>
    </div>
  </div>
</div>


  <!-- Tournament quick-open button -->
  <button id="tab-tournament" style="position:fixed; right:16px; bottom:16px; z-index:9999;">
    Tournament
  </button>

  <!-- Tournament overlay -->
  <div id="view-tournament" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.65); z-index:9998; overflow:auto;">
    <div style="max-width:1100px; margin:40px auto; background:#111; color:#eee; border-radius:12px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,0.4);">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:8px;">
        <h2 style="margin:0; font-size:20px;">Tournament Center</h2>
        <button id="closeTournamentBtn">Close</button>
      </div>

      <div class="card" style="margin-bottom:12px;">
        <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
          <label for="tournamentSelect">Tournament</label>
          <select id="tournamentSelect" style="min-width:220px;"></select>
        </div>
      </div>

      <!-- Public views -->
      <div class="card" style="margin-bottom:12px;">
        <h3 style="margin-top:0;">Who you play next and which net</h3>
        <div id="publicNextMatches"></div>
      </div>

      <div class="card" style="margin-bottom:12px;">
        <h3 style="margin-top:0;">Pool standings with record and point difference</h3>
        <div id="poolStandings"></div>
      </div>

      <div class="card" style="margin-bottom:12px;">
        <h3 style="margin-top:0;">Report pool match score</h3>
        <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin-bottom:8px;">
          <label for="reportMatchSelect">Match</label>
          <select id="reportMatchSelect" style="min-width:280px;"></select>

          <label for="teamA_score">Team A</label>
          <input id="teamA_score" type="number" min="0" step="1" style="width:90px;" />

          <label for="teamB_score">Team B</label>
          <input id="teamB_score" type="number" min="0" step="1" style="width:90px;" />

          <label for="reporterTeam">Your team name</label>
          <input id="reporterTeam" type="text" placeholder="Type your team name" style="min-width:180px;" />

          <button id="submitScoreBtn">Submit</button>
        </div>
        <p id="reportStatus" class="small" style="margin:0;"></p>
      </div>

      <!-- Admin only panel is auto-hidden when not admin -->
      <div id="adminTournament" class="card" style="margin-bottom:12px;">
        <h3 style="margin-top:0;">Admin: setup pools and schedule</h3>

        <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin-bottom:8px;">
          <input id="newTournamentName" type="text" placeholder="Tournament name" />
          <input id="newTournamentNets" type="number" min="1" value="3" style="width:100px;" />
          <button id="createTournamentBtn">Create tournament</button>
        </div>

        <h4 style="margin:8px 0;">Add teams (one per line)</h4>
        <textarea id="bulkTeams" rows="6" style="width:100%;"></textarea>
        <div style="margin:8px 0;">
          <button id="addTeamsBtn">Add teams</button>
        </div>

        <h4 style="margin:8px 0;">Pools JSON</h4>
        <p class="small" style="margin:0 0 6px 0;">Example: [{"name":"Pool A","teams":["Team 1","Team 2","Team 3","Team 4"]},{"name":"Pool B","teams":["Team 5","Team 6","Team 7","Team 8"]}]</p>
        <textarea id="poolsJson" rows="6" style="width:100%;">[]</textarea>
        <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin:8px 0;">
          <button id="savePoolsBtn">Save pools</button>
          <button id="generatePoolScheduleBtn">Generate pool schedule</button>
        </div>

        <h4 style="margin:8px 0;">Admin rankings view</h4>
        <div id="adminRankings"></div>
      </div>
    </div>
  </div>

</body>
</html>
</html>
